# 拡散モデルにおけるユニバーサルガイダンス - 要約

## 背景と課題
- 従来の拡散モデルは特定の条件付けモダリティ（例: テキスト）に対して訓練されており、新しいモダリティに対応するには再訓練が必要でした。
- ガイダンスアプローチは外部関数を使用してモデルを誘導する柔軟性を提供しますが、ノイズの多い画像とクリーンな画像の間のドメインシフトが課題となります。

## 提案手法
本研究では、ドメインギャップを解消するために、**ユニバーサルガイダンスアルゴリズム**を提案します。このアルゴリズムはガイダンスモデルをノイズ除去された画像に対して評価することで機能します。主な構成要素は以下の通りです：
1. **前向きガイダンス（Forward Guidance）**  
   サンプリングプロセス中に生成された画像をプロンプトに合わせます。
2. **後向きガイダンス（Backward Guidance）**  
   クリーンな画像空間での最適化を通じて、生成画像とプロンプトの整合性を強化します。
3. **ステップごとの自己再帰（Per-Step Self-Recurrence）**  
   実画像としての自然さを保ちながら、ガイダンス制約への適合を反復的に改善します。

## 実験結果
### CLIPガイダンス
- テキストベースの画像生成は、従来の条件付きモデルと比較可能な品質を達成しました。

### セグメンテーションマップガイダンス
- オブジェクトと背景を明確に分離した高品質な画像を生成しました。

### 顔認識ガイダンス
- 指定された顔の特徴を再現し、背景やスタイル記述とも調和した画像を生成しました。

### オブジェクト位置ガイダンス
- 指定された位置にオブジェクトを正確に配置し、カテゴリと一致させることに成功しました。

### スタイル転送
- テキストプロンプトとスタイル画像を組み合わせて、視覚的に一貫性のある結果を生成しました。

## 貢献
- 分類器ラベル、セグメンテーションマップ、顔認識、物体検出など、さまざまなガイダンスモダリティをサポートします。
- 複数のガイダンス関数を同時に利用することで、画像品質と忠実度を向上させます。

## 制約
- 複雑なガイダンス関数の場合、生成速度が標準的な条件付き生成より遅くなることがあります。
- 最適な結果を得るためには、ハイパーパラメータの調整が必要です。

## 結論
本研究で提案したユニバーサルガイダンスアルゴリズムは、固定された基盤拡散モデルを使用しつつ、多様な用途に適応可能です。再訓練なしで任意のガイダンス関数を用いてガイド付き画像生成を実現でき、セグメンテーション、顔認識、物体検出システムなど、複雑なガイダンスを含む実験において有望な結果を示しました。また、複数のガイダンス関数を組み合わせて使用することも可能であることを実証しました。