
# Denoising Diffusion Probabilistic Models (DDPM) 

## **概要**
拡散確率モデルは、生成モデルとして高品質な画像生成を実現する手法で、特にノイズを加える「前向きプロセス」と、それを逆に進めてノイズを取り除く「逆プロセス」を通じてデータを生成します。本研究では、変分推論やスコアマッチングとの関連を活用し、最先端の画像生成性能を達成しました。

---

## **1. はじめに**
深層生成モデル（GAN、自己回帰モデル、フロー、VAEなど）が近年高品質なサンプル生成を可能にしてきた中、拡散モデルは新しい選択肢として注目されています。本研究では、以下を目指します：
- 拡散モデルの性能をGANや他の生成モデルと比較。
- 変分推論、スコアマッチング、Langevinダイナミクスとの関連を明確化。
- 高品質なサンプル生成のための設計戦略を提案。

---

## **2. 背景**
### **拡散モデルの定義**
- **前向きプロセス (Forward Process)**:
  データにノイズを徐々に加え、ガウス分布に収束させるマルコフ連鎖。分布は以下で定義される：
  \[
  q(x_t|x_{t-1}) = \mathcal{N}(x_t; \sqrt{1-\beta_t} x_{t-1}, \beta_t I)
  \]
  ノイズはスケジュール \(\beta_t\) に従って段階的に加えられる。

- **逆プロセス (Reverse Process)**:
  前向きプロセスを反転させ、条件付きガウス分布を用いてデータを生成：
  \[
  p_\theta(x_{t-1}|x_t) = \mathcal{N}(x_{t-1}; \mu_\theta(x_t, t), \Sigma_\theta(x_t, t))
  \]

### **トレーニング目標**
- 変分推論に基づく負の対数尤度の境界を最小化：
  \[
  \mathcal{L} = \mathbb{E}_q \left[ -\log p_\theta(x_{0:T}) + \log q(x_{1:T}|x_0) \right]
  \]

---

## **3. 拡散モデルとデノイジングオートエンコーダ**
### **設計戦略**
1. **前向きプロセス (Forward Process)**:
   - スケジュール \(\beta_t\) を定数として設定。
   - 信号が完全に破壊されるよう調整 (\( D_\text{KL}(q(x_T|x_0) \parallel \mathcal{N}(0, I)) \approx 0 \))。

2. **逆プロセス (Reverse Process)**:
   - 平均 \(\mu_\theta\) をノイズ推定 \(\epsilon_\theta\) に基づいて再構成：
     \[
     \mu_\theta(x_t, t) = \frac{1}{\sqrt{\alpha_t}} \left( x_t - \frac{\beta_t}{\sqrt{1 - \bar{\alpha}_t}} \epsilon_\theta(x_t, t) \right)
     \]

3. **簡略化されたトレーニング目標**:
   - 元の目標関数を次のように簡略化：
     \[
     \mathcal{L}_\text{simple} = \mathbb{E}_{x_0, \epsilon} \left[ \| \epsilon - \epsilon_\theta(x_t, t) \|^2 \right]
     \]

---

## **4. 実験**
### **設定**
- CIFAR10 (32x32画像): モデルパラメータ 35.7M。
- CelebA-HQ、LSUN (256x256画像): モデルパラメータ 114M。

### **結果**
1. **CIFAR10**:
   - FIDスコア: 3.17。
   - Inceptionスコア: 9.46。

2. **CelebA-HQ/LSUN**:
   - 高品質なサンプル生成を実現。

3. **レート-歪み特性**:
   - 損失圧縮と画像再構成の性能を定量化。

---

## **5. 関連研究**
### **比較ポイント**
1. **スコアベース生成モデル**:
   - 拡散モデルは、スコアマッチングと変分推論を統合したアプローチ。
   - Langevinダイナミクスに類似したサンプリングを実現。

2. **他の生成モデルとの違い**:
   - GANより安定性が高く、サンプル品質が優れる。
   - フローやVAEとは異なり、単純なガウス分布を仮定。

---

## **6. 結論**
- 拡散モデルは、画像生成の新しい基準を確立。
- 他の生成モデルや応用分野（圧縮、創造的生成など）への展開可能性を示唆。